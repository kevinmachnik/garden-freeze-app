<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garden Frost Alert üå±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }


    body {
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 40px;
        max-width: 500px;
        width: 100%;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(10px);
    }

    h1 {
        text-align: center;
        color: #2d3748;
        margin-bottom: 10px;
        font-size: 2em;
    }

    .subtitle {
        text-align: center;
        color: #718096;
        margin-bottom: 30px;
        font-size: 0.9em;
    }

    .status-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
    }

    .status-card:hover {
        transform: translateY(-2px);
    }

    .alert-safe {
        border-left: 5px solid #48bb78;
        background: linear-gradient(90deg, rgba(72, 187, 120, 0.1) 0%, transparent 100%);
    }

    .alert-warning {
        border-left: 5px solid #f6ad55;
        background: linear-gradient(90deg, rgba(246, 173, 85, 0.1) 0%, transparent 100%);
        animation: pulse 2s infinite;
    }

    .alert-danger {
        border-left: 5px solid #fc8181;
        background: linear-gradient(90deg, rgba(252, 129, 129, 0.2) 0%, transparent 100%);
        animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.9; }
    }

    .status-icon {
        font-size: 3em;
        text-align: center;
        margin-bottom: 15px;
    }

    .status-message {
        font-size: 1.2em;
        font-weight: 600;
        color: #2d3748;
        margin-bottom: 10px;
    }

    .status-details {
        color: #4a5568;
        line-height: 1.6;
    }

    .temperature-display {
        display: flex;
        justify-content: space-around;
        margin: 20px 0;
        flex-wrap: wrap;
        gap: 15px;
    }

    .temp-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        text-align: center;
        flex: 1;
        min-width: 120px;
    }

    .temp-label {
        font-size: 0.85em;
        opacity: 0.9;
        margin-bottom: 5px;
    }

    .temp-value {
        font-size: 1.8em;
        font-weight: bold;
    }

    .location-info {
        text-align: center;
        color: #718096;
        margin-bottom: 20px;
        font-size: 0.9em;
    }

    .check-button {
        width: 100%;
        padding: 15px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.1em;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .check-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }

    .check-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .loading {
        text-align: center;
        color: #718096;
        padding: 20px;
    }

    .spinner {
        border: 3px solid #f3f4f6;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 20px auto;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .error {
        background: #fed7d7;
        color: #c53030;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 20px;
    }

    .forecast-hours {
        margin-top: 20px;
        max-height: 200px;
        overflow-y: auto;
        padding: 10px;
        background: #f7fafc;
        border-radius: 10px;
    }

    .hour-item {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        border-bottom: 1px solid #e2e8f0;
    }

    .hour-item:last-child {
        border-bottom: none;
    }

    .freezing-hour {
        color: #c53030;
        font-weight: 600;
    }

    .tips {
        background: #f7fafc;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
    }

    .tips h3 {
        color: #2d3748;
        margin-bottom: 10px;
        font-size: 1.1em;
    }

    .tips ul {
        color: #4a5568;
        padding-left: 20px;
    }

    .tips li {
        margin-bottom: 8px;
    }
</style>


</head>
<body>
    <div class="container">
        <h1>üå± Garden Frost Alert</h1>
        <p class="subtitle">Protect your crops from freezing temperatures</p>


    <div class="location-info" id="locationInfo">
        Click below to check your local forecast
    </div>

    <div id="statusContainer"></div>
    
    <button class="check-button" id="checkButton" onclick="checkWeather()">
        Check Frost Risk Now
    </button>

    <div id="forecastContainer"></div>
    
    <div id="tipsContainer"></div>
</div>

<script>
    let userLat = null;
    let userLon = null;

    async function checkWeather() {
        const button = document.getElementById('checkButton');
        const statusContainer = document.getElementById('statusContainer');
        const locationInfo = document.getElementById('locationInfo');
        const forecastContainer = document.getElementById('forecastContainer');
        const tipsContainer = document.getElementById('tipsContainer');
        
        button.disabled = true;
        statusContainer.innerHTML = '<div class="loading"><div class="spinner"></div>Getting your location...</div>';
        forecastContainer.innerHTML = '';
        tipsContainer.innerHTML = '';

        try {
            // Get user location
            const position = await new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(resolve, reject, {
                    timeout: 10000,
                    enableHighAccuracy: true
                });
            });

            userLat = position.coords.latitude;
            userLon = position.coords.longitude;

            locationInfo.innerHTML = `Location: ${userLat.toFixed(2)}¬∞, ${userLon.toFixed(2)}¬∞`;
            statusContainer.innerHTML = '<div class="loading"><div class="spinner"></div>Checking weather forecast...</div>';

            // Fetch weather data from Open-Meteo API (free, no API key needed)
            const response = await fetch(
                `https://api.open-meteo.com/v1/forecast?latitude=${userLat}&longitude=${userLon}&hourly=temperature_2m&temperature_unit=fahrenheit&timezone=auto&forecast_days=2`
            );

            if (!response.ok) throw new Error('Weather service unavailable');

            const data = await response.json();
            
            // Process the next 24 hours of data
            const now = new Date();
            const temps = [];
            const freezingHours = [];
            
            for (let i = 0; i < 24 && i < data.hourly.time.length; i++) {
                const time = new Date(data.hourly.time[i]);
                const temp = data.hourly.temperature_2m[i];
                
                temps.push(temp);
                
                if (temp <= 32) {
                    freezingHours.push({
                        time: time.toLocaleTimeString('en-US', { 
                            hour: 'numeric', 
                            hour12: true,
                            weekday: 'short'
                        }),
                        temp: Math.round(temp)
                    });
                }
            }

            const minTemp = Math.min(...temps);
            const maxTemp = Math.max(...temps);
            const currentTemp = temps[0];

            // Display status
            let statusHTML = '';
            
            if (freezingHours.length > 0) {
                statusHTML = `
                    <div class="status-card alert-danger">
                        <div class="status-icon">‚ùÑÔ∏è</div>
                        <div class="status-message">FROST WARNING!</div>
                        <div class="status-details">
                            Freezing temperatures expected in the next 24 hours!
                            <br>Protect your sensitive plants immediately.
                            <br><strong>${freezingHours.length} hours</strong> at or below freezing.
                        </div>
                    </div>
                `;
                
                // Show protection tips
                tipsContainer.innerHTML = `
                    <div class="tips">
                        <h3>üõ°Ô∏è Protection Actions:</h3>
                        <ul>
                            <li>Cover sensitive plants with frost cloth, sheets, or blankets</li>
                            <li>Water plants thoroughly before sunset (wet soil holds heat better)</li>
                            <li>Harvest ripe vegetables and tender herbs</li>
                            <li>Move potted plants indoors or to a protected area</li>
                            <li>Add mulch around plant bases for insulation</li>
                        </ul>
                    </div>
                `;
            } else if (minTemp <= 36) {
                statusHTML = `
                    <div class="status-card alert-warning">
                        <div class="status-icon">‚ö†Ô∏è</div>
                        <div class="status-message">Near-Freezing Alert</div>
                        <div class="status-details">
                            Temperatures will drop close to freezing (${Math.round(minTemp)}¬∞F).
                            <br>Monitor closely and be ready to protect sensitive plants.
                        </div>
                    </div>
                `;
            } else {
                statusHTML = `
                    <div class="status-card alert-safe">
                        <div class="status-icon">‚úÖ</div>
                        <div class="status-message">No Frost Risk</div>
                        <div class="status-details">
                            Your garden is safe! No freezing temperatures expected in the next 24 hours.
                            <br>Minimum temperature: ${Math.round(minTemp)}¬∞F
                        </div>
                    </div>
                `;
            }

            statusHTML += `
                <div class="temperature-display">
                    <div class="temp-card">
                        <div class="temp-label">Current</div>
                        <div class="temp-value">${Math.round(currentTemp)}¬∞F</div>
                    </div>
                    <div class="temp-card">
                        <div class="temp-label">24hr Low</div>
                        <div class="temp-value">${Math.round(minTemp)}¬∞F</div>
                    </div>
                    <div class="temp-card">
                        <div class="temp-label">24hr High</div>
                        <div class="temp-value">${Math.round(maxTemp)}¬∞F</div>
                    </div>
                </div>
            `;

            statusContainer.innerHTML = statusHTML;

            // Show hourly forecast if there are freezing hours
            if (freezingHours.length > 0) {
                let forecastHTML = '<div class="forecast-hours"><h3>‚ùÑÔ∏è Freezing Hours:</h3>';
                freezingHours.forEach(hour => {
                    forecastHTML += `
                        <div class="hour-item freezing-hour">
                            <span>${hour.time}</span>
                            <span>${hour.temp}¬∞F</span>
                        </div>
                    `;
                });
                forecastHTML += '</div>';
                forecastContainer.innerHTML = forecastHTML;
            }

        } catch (error) {
            console.error('Error:', error);
            
            let errorMessage = 'Unable to check weather. ';
            if (error.code === 1) {
                errorMessage += 'Please enable location access.';
            } else if (error.message === 'Weather service unavailable') {
                errorMessage += 'Weather service is temporarily unavailable.';
            } else {
                errorMessage += 'Please try again.';
            }
            
            statusContainer.innerHTML = `<div class="error">${errorMessage}</div>`;
        } finally {
            button.disabled = false;
        }
    }

    // Check on page load
    window.addEventListener('load', () => {
        // Auto-check if geolocation is available
        if ('geolocation' in navigator) {
            // Optionally auto-check on load
            // checkWeather();
        } else {
            document.getElementById('statusContainer').innerHTML = 
                '<div class="error">Geolocation is not supported by your browser.</div>';
        }
    });
</script>


</body>
</html>
